<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Valentine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap');
        
        body { 
            font-family: 'Poppins', sans-serif; 
            overflow-x: hidden;
            cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='40' height='48' style='fill:black;font-size:24px;'><text y='50%'>‚ù§Ô∏è</text></svg>") 16 0, auto;
        }
        
        .handwriting { font-family: 'Dancing Script', cursive; }
        
        html { scroll-behavior: smooth; }
        
        .heart-bg {
            background-color: #fdf2f8;
            position: relative;
        }
         .glass {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Animated Background Hearts */
        .floating-heart {
            position: fixed;
            pointer-events: none;
            z-index: -1;
            opacity: 0.4;
            animation: floatUp linear infinite;
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) rotate(0deg) scale(0.5); opacity: 0; }
            10% { opacity: 0.4; }
            90% { opacity: 0.4; }
            100% { transform: translateY(-20vh) rotate(360deg) scale(1.2); opacity: 0; }
        }


        .heart-bg::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background-image: 
                linear-gradient(to bottom, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 50%, rgba(255, 192, 203, 0.6) 100%),
                url('images/photo12.JPG'); 
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            will-change: transform;
        }

        .fade-in {
            animation: fadeIn 1.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: rgba(253, 242, 248, 0.5); }
        ::-webkit-scrollbar-thumb { background: #f472b6; border-radius: 10px; }

        .timeline-line {
            position: absolute;
            left: 50%;
            top: 0;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background-color: #f472b6;
            border-radius: 2px;
        }
        
        .floating-heart {
            position: fixed;
            bottom: -10vh;
            font-size: 2rem;
            animation: floatUp linear forwards;
            z-index: -1;
            opacity: 0.7;
            pointer-events: none;
        }
        
        @keyframes floatUp {
            to {
                bottom: 110vh;
                transform: rotate(360deg);
                opacity: 0;
            }
        }

        .cursor-blink {
            display: inline-block;
            width: 2px;
            background-color: #ec4899;
            animation: blink 1s step-end infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }

        .envelope { transition: transform 0.3s ease; }
        .envelope:hover { transform: translateY(-10px); }

        /* Polaroid Image Styling - Prevent Cropping */
        .polaroid-img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* Shows full image without cropping */
            background-color: #f3f4f6; /* Light gray background for different aspect ratios */
            border-radius: 2px;
        }
    </style>
</head>
<body class="heart-bg text-gray-800 antialiased overflow-hidden" id="mainBody">

    <!-- LOCK SCREEN -->
    <div id="lockScreen" class="fixed inset-0 z-[100] bg-pink-100 flex flex-col items-center justify-center text-center p-6 transition-all duration-1000">
        <div class="bg-white p-8 rounded-3xl shadow-2xl border-4 border-pink-300 max-w-md w-full">
            <h1 class="text-4xl handwriting text-pink-600 mb-4">Unlock My Heart üîí</h1>
            <p class="text-gray-600 mb-6">Enter the day and month we started our journey (DDMMYY)</p>
            <input type="password" id="passcode" maxlength="6" class="w-full text-center text-3xl tracking-widest p-3 border-2 border-pink-200 rounded-xl focus:outline-none focus:border-pink-500 mb-6 text-pink-600 placeholder-pink-200" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            <button onclick="checkPasscode()" class="w-full bg-pink-500 text-white font-bold py-3 rounded-xl hover:bg-pink-600 transition shadow-lg">UNLOCK</button>
            <p id="errorMsg" class="text-red-500 mt-4 hidden">Wrong code! Hint: It's in March üòâ</p>
        </div>
    </div>

    <!-- Background Music -->
    <audio id="bgMusic" loop>
        <source src="mitwa.mp3" type="audio/mpeg">
    </audio>

    <button id="musicBtn" class="fixed top-4 right-4 z-50 bg-white/80 backdrop-blur-md p-3 rounded-full shadow-lg text-pink-600 hover:scale-110 transition-transform animate-pulse hidden">
        üéµ
    </button>

    <div id="heartsContainer"></div>

    <!-- Hero Section -->
    <div class="min-h-screen flex flex-col justify-center items-center text-center p-6 relative">
        <div class="fade-in">
            <h1 class="text-6xl md:text-8xl font-bold text-pink-600 mb-4 animate-bounce">
                Happy Valentine's Day!
            </h1>
            <p class="text-xl md:text-3xl text-gray-600 mb-10 handwriting">
                To the person who makes my world brighter.
            </p>
            
            <div class="bg-white/80 backdrop-blur-sm p-8 rounded-3xl shadow-2xl border-2 border-pink-100 inline-block">
                <p class="text-pink-400 uppercase tracking-widest text-xs font-bold mb-3">We've been together for</p>
                <div id="counter" class="text-2xl md:text-4xl font-mono font-bold text-pink-600">
                    00 Days : 00 Hrs : 00 Min : 00 Sec
                </div>
            </div>
        </div>
        
        <div class="absolute bottom-10 animate-bounce text-pink-400">
            <p class="text-sm font-semibold">Scroll for our story</p>
            <svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
        </div>
    </div>

    <!-- Memory Gallery -->
    <section class="max-w-md mx-auto px-6 py-20 text-center">
        <h2 class="text-4xl handwriting text-pink-600 mb-12">Our Memories</h2>
        
        <!-- Stack Container -->
        <div id="stackContainer" class="relative w-72 h-80 mx-auto cursor-pointer group select-none">
            <!-- Photos without text and without cropping. Added loading="lazy" to all for better performance -->
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo1.jpg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+1'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo2.jpg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+2'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo3.jpg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+3'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo4.webp" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+4'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo5.jpg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+5'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo6.jpg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+6'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo7.JPG" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+7'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo8.JPG" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+8'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo9.jpg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+9'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo10.JPG" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+10'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo11.JPG" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+11'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo12.JPG" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+12'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo13.JPG" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+13'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo14.jpg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+14'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo15.jpg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+15'">
            </div>
            <div class="polaroid absolute inset-0 bg-white p-2 pb-6 shadow-xl border border-gray-100 transform transition-all duration-700 ease-in-out">
                <img src="images/photo16.jpeg" class="polaroid-img" loading="lazy" onerror="this.src='https://placehold.co/400x500/pink/white?text=Memory+16'">
            </div>
        </div>
        <p class="text-sm text-black-400 mt-8 animate-pulse">Click the stack to flip through!</p>
    </section>

    <!-- Relationship Timeline -->
    <section class="max-w-4xl mx-auto px-6 py-20 mb-24">
        <h2 class="text-4xl handwriting text-center text-pink-600 mb-12">Our Journey</h2>
        <div class="relative">
            <div class="timeline-line"></div>
            <div class="space-y-12">
                <div class="flex flex-col md:flex-row items-center justify-between relative w-full">
                    <div class="w-full md:w-5/12 bg-white/90 p-6 rounded-xl shadow-lg border border-pink-100 text-right">
                        <h3 class="font-bold text-pink-500 text-xl">07/03/2025</h3>
                        <p class="text-gray-600 text-sm">The day we started our journey together</p>
                    </div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-4 h-4 bg-pink-500 rounded-full border-4 border-white shadow"></div>
                    <div class="w-full md:w-5/12"></div>
                </div>

                <div class="flex flex-col md:flex-row items-center justify-between relative w-full">
                    <div class="w-full md:w-5/12"></div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-4 h-4 bg-pink-500 rounded-full border-4 border-white shadow"></div>
                    <div class="w-full md:w-5/12 bg-white/90 p-6 rounded-xl shadow-lg border border-pink-100 text-left">
                        <h3 class="font-bold text-pink-500 text-xl">28/05/2025</h3>
                        <p class="text-gray-600 text-sm">Our first trip together</p>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row items-center justify-between relative w-full">
                    <div class="w-full md:w-5/12 bg-white/90 p-6 rounded-xl shadow-lg border border-pink-100 text-right">
                        <h3 class="font-bold text-pink-500 text-xl">20/09/2025</h3>
                        <p class="text-gray-600 text-sm">Our first Kiss</p>
                    </div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-4 h-4 bg-pink-500 rounded-full border-4 border-white shadow"></div>
                    <div class="w-full md:w-5/12"></div>
                </div>

                <div class="flex flex-col md:flex-row items-center justify-between relative w-full">
                    <div class="w-full md:w-5/12"></div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-4 h-4 bg-pink-500 rounded-full border-4 border-white shadow"></div>
                    <div class="w-full md:w-5/12 bg-white/90 p-6 rounded-xl shadow-lg border border-pink-100 text-left">
                        <h3 class="font-bold text-pink-500 text-xl">17/01/2026</h3>
                        <p class="text-gray-600 text-sm">An unforgettable trip with you to Kanyakumari</p>
                    </div>
                </div>
                <div class="flex flex-col md:flex-row items-center justify-between relative w-full">
                    <div class="w-full md:w-5/12 bg-white/90 p-6 rounded-xl shadow-lg border border-pink-100 text-right">
                        <h3 class="font-bold text-pink-500 text-xl">Today</h3>
                        <p class="text-gray-600 text-sm">Still falling in love with you</p>
                    </div>
                    <div class="absolute left-1/2 transform -translate-x-1/2 w-4 h-4 bg-pink-500 rounded-full border-4 border-white shadow"></div>
                    <div class="w-full md:w-5/12"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Open When Envelopes -->
    <section class="max-w-4xl mx-auto px-6 py-20 bg-white/40 backdrop-blur-md rounded-3xl mb-24 shadow-lg border border-pink-200">
        <h2 class="text-4xl handwriting text-center text-pink-600 mb-12">Open When...</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div onclick="openEnvelope('miss')" class="envelope cursor-pointer bg-white p-8 rounded-xl shadow-lg border-2 border-pink-200">
                <div class="text-6xl mb-4"></div>
                <h3 class="font-bold text-gray-700">You Miss Me</h3>
            </div>
            <div onclick="openEnvelope('sad')" class="envelope cursor-pointer bg-white p-8 rounded-xl shadow-lg border-2 border-pink-200">
                <div class="text-6xl mb-4"></div>
                <h3 class="font-bold text-gray-700">You're Sad</h3>
            </div>
            <div onclick="openEnvelope('happy')" class="envelope cursor-pointer bg-white p-8 rounded-xl shadow-lg border-2 border-pink-200">
                <div class="text-6xl mb-4"></div>
                <h3 class="font-bold text-gray-700">You're Happy</h3>
            </div>
        </div>
    </section>

    <!-- Reasons I Love You -->
    <section class="max-w-xl mx-auto px-6 py-20 text-center mt-24">
        <h2 class="text-4xl handwriting text-pink-600 mb-6">Why I Love You</h2>
        <div class="bg-white/90 backdrop-blur-md p-8 rounded-2xl shadow-xl border-2 border-pink-200 min-h-[150px] flex flex-col items-center justify-center">
            <p id="reasonText" class="text-xl text-gray-700 font-medium mb-6">Click the button to see why!</p>
            <button onclick="generateReason()" class="px-6 py-2 bg-pink-500 text-white rounded-full font-bold hover:bg-pink-600 transition shadow-md">
                Tell Me Another Reason üíñ
            </button>
        </div>
    </section>

    <!-- Love Note -->
    <section id="noteSection" class="max-w-3xl mx-auto px-8 py-20 bg-white/80 backdrop-blur-md rounded-3xl shadow-xl border border-pink-100 mb-20 relative overflow-hidden min-h-[500px]">
        <div class="absolute -top-10 -right-10 text-pink-100">
            <svg class="w-40 h-40 fill-current" viewBox="0 0 20 20"><path d="M10 3.22l-.61-.6a5.5 5.5 0 0 0-7.78 7.77L10 18.78l8.39-8.4a5.5 5.5 0 0 0-7.78-7.77l-.61.61z"/></svg>
        </div>
        <h2 class="text-4xl handwriting text-pink-600 mb-8 flex items-center gap-3">
            A Note for You üíå
        </h2>
        <div class="space-y-4 text-gray-700 leading-relaxed text-lg">
            <p id="typewriterText"></p><span class="cursor-blink">&nbsp;</span>
        </div>
        <p class="text-right mt-10 handwriting text-3xl text-pink-500">- Kashi</p>
    </section>

    <!-- SURPRISE VIDEO SECTION -->
    <section class="max-w-3xl mx-auto px-6 py-20 text-center relative z-10 flex flex-col items-center">
        <h2 class="text-4xl handwriting text-pink-600 mb-8">One Last Surprise... üéÅ</h2>
        
        <!-- Surprise Button -->
        <button id="surpriseBtn" onclick="revealVideo()" class="group relative inline-flex items-center justify-center px-10 py-4 font-bold text-white transition-all duration-300 bg-gradient-to-r from-pink-400 to-pink-600 rounded-full shadow-xl hover:scale-105 hover:shadow-pink-300/50 animate-bounce">
            <span class="text-xl tracking-wide">Click for your Surprise</span>
        </button>

        <!-- Video Container (Hidden initially) -->
        <div id="videoContainer" class="hidden w-full mt-4 transition-all duration-700 opacity-0 transform scale-95">
            <div class="p-2 bg-white/80 rounded-3xl shadow-2xl border-2 border-pink-200 transform-gpu">
                <div class="relative rounded-2xl overflow-hidden bg-black aspect-video flex items-center justify-center">
                    <!-- Changed preload to "metadata" to stop huge video files from blocking page load -->
                    <video id="surpriseVideo" class="w-full h-full object-cover" controls playsInline preload="metadata">
                        <source src="images/valentine.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            </div>
            <button onclick="closeVideo()" class="mt-8 px-8 py-3 bg-white/80 hover:bg-white text-pink-600 font-bold rounded-full shadow-md transition-colors border border-pink-200">
                Close Video
            </button>
        </div>
    </section>

    <!-- Proposal -->
    <div class="min-h-screen flex flex-col justify-center items-center p-6 text-center">
        <div class="bg-white/60 backdrop-blur-md p-10 rounded-3xl shadow-2xl">
            <h2 class="text-5xl md:text-7xl font-bold text-pink-600 mb-12 handwriting">Do you love me??</h2>
            <div id="proposalContainer" class="flex flex-col md:flex-row gap-8 items-center justify-center min-h-[200px] w-full relative">
                <button id="yesBtn" onclick="handleYes()" class="px-12 py-5 bg-green-500 text-white font-bold rounded-full text-2xl shadow-xl transform transition hover:scale-110 active:scale-95">
                    YES! ‚ù§Ô∏è
                </button>
                <button id="noBtn" onclick="showNoModal()" class="px-12 py-5 bg-red-500 text-white font-bold rounded-full text-2xl shadow-xl">
                    NO üíî
                </button>
            </div>
            <div id="successMessage" class="hidden text-center fade-in">
                <h3 class="text-4xl font-bold text-pink-600 mb-4">I love youuuuhhh üíñ</h3>
                <p class="text-xl text-gray-600">You've made me the happiest person alive!</p>
            </div>
        </div>
    </div>

    <footer class="bg-pink-100/80 backdrop-blur-md py-8 text-center text-pink-500 text-sm font-semibold">
        <p>Made with ‚ù§Ô∏è by Kashi</p>
        <p class="mt-2 text-xs">Forever & Always</p>
    </footer>

    <!-- Modals -->
    <div id="envelopeModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-[150] p-4 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full text-center relative border-4 border-pink-200">
            <button onclick="closeEnvelope()" class="absolute top-4 right-4 text-gray-400 text-2xl">&times;</button>
            <div class="text-5xl mb-4">üíå</div>
            <h3 id="envTitle" class="text-2xl font-bold text-pink-600 mb-4 handwriting"></h3>
            <p id="envMessage" class="text-gray-700 leading-relaxed"></p>
        </div>
    </div>

    <div id="noOptionModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-[150] p-4 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-2xl shadow-2xl text-center max-w-md border-4 border-pink-300">
            <h3 class="text-3xl font-bold text-pink-600 mb-6 handwriting">You have no other option!</h3>
            <p class="text-xl text-gray-700 mb-8">You have to love me!</p>
            <button onclick="handleYes()" class="px-8 py-3 bg-green-500 text-white font-bold rounded-full text-xl shadow-lg">
                YES! ‚ù§Ô∏è
            </button>
        </div>
    </div>

    <script>
        // POLAROID STACK LOGIC
        const stackContainer = document.getElementById('stackContainer');

        function initPolaroids() {
            const photos = document.querySelectorAll('.polaroid');
            photos.forEach(photo => {
                const randomRot = Math.random() * 12 - 6; 
                photo.style.transform = `rotate(${randomRot}deg)`;
            });
        }

        stackContainer.addEventListener('click', () => {
            const currentPhotos = Array.from(document.querySelectorAll('.polaroid'));
            const topPhoto = currentPhotos[currentPhotos.length - 1]; 
            
            if (!topPhoto) return;

            const randomX = Math.random() * 200 - 100;
            topPhoto.style.transform = `translate(${randomX}px, -100vh) rotate(45deg)`;
            topPhoto.style.opacity = '0';
            
            setTimeout(() => {
                stackContainer.prepend(topPhoto);
                const randomRot = Math.random() * 12 - 6;
                topPhoto.style.transform = `rotate(${randomRot}deg)`;
                topPhoto.style.opacity = '1';
            }, 700);
        });

        window.addEventListener('load', initPolaroids);

        // LOCK SCREEN LOGIC
        function checkPasscode() {
            const input = document.getElementById('passcode').value;
            const lockScreen = document.getElementById('lockScreen');
            const mainBody = document.getElementById('mainBody');
            const music = document.getElementById('bgMusic');
            const musicBtn = document.getElementById('musicBtn');

            if (input === '070325') {
                lockScreen.style.opacity = '0';
                setTimeout(() => {
                    lockScreen.style.display = 'none';
                    mainBody.style.overflow = 'auto';
                    musicBtn.classList.remove('hidden');
                    music.play().catch(e => console.log("Interaction needed for audio"));
                }, 1000);
            } else {
                document.getElementById('errorMsg').classList.remove('hidden');
                document.getElementById('passcode').value = '';
            }
        }

        // ENVELOPE MESSAGES
        const messages = {
            'miss': { title: "When You Miss Me", text: "Remember that I am always with you, in your heart and just a phone call away. Distance means so little when someone means so much. I miss you too! ‚ù§Ô∏è" },
            'sad': { title: "When You're Sad", text: "It's okay to have bad days. Just remember that you are strong, beautiful, and loved beyond measure. This storm will pass, and I'll be here holding your umbrella." },
            'happy': { title: "When You're Happy", text: "Your happiness is my favorite thing in the world! Keep smiling that beautiful smile. I hope I can add even more joy to your day. Love you! üéâ" }
        };

        function openEnvelope(type) {
            const modal = document.getElementById('envelopeModal');
            document.getElementById('envTitle').innerText = messages[type].title;
            document.getElementById('envMessage').innerText = messages[type].text;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeEnvelope() {
            document.getElementById('envelopeModal').classList.add('hidden');
        }

        // DATE COUNTER
        const startDate = new Date("2025-03-07"); 
        function updateCounter() {
            const diff = new Date() - startDate;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((diff / 1000 / 60) % 60);
            const seconds = Math.floor((diff / 1000) % 60);
            document.getElementById("counter").innerText = `${Math.abs(days)} Days : ${Math.abs(hours)} Hrs : ${Math.abs(minutes)} Min : ${Math.abs(seconds)} Sec`;
        }
        setInterval(updateCounter, 1000);
        updateCounter();

        // MUSIC TOGGLE
        const music = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');
        musicBtn.addEventListener('click', () => {
            if (music.paused) { music.play(); musicBtn.innerText = "üéµ"; }
            else { music.pause(); musicBtn.innerText = "üîá"; }
        });

        // PROPOSAL
        function showNoModal() {
            const modal = document.getElementById('noOptionModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function handleYes() {
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            document.getElementById('proposalContainer').classList.add('hidden');
            document.getElementById('successMessage').classList.remove('hidden');
            document.getElementById('noOptionModal').classList.add('hidden');
        }

        // TYPEWRITER
        const noteText = `Achuuuu<br><br>
        This Valentine‚Äôs Day, I don‚Äôt just want to tell you that I love you‚ÄîI want to thank you from the deepest part of my heart. You came into my life when I was at my lowest, and yet, you stayed. You understood me when I couldn‚Äôt even understand myself.<br><br>
        In this generation, having a loyal heart like yours feels almost impossible to find. You chose me, stayed with me, and loved me through my weakest moments. That loyalty, that patience, that care... it means everything to me.<br><br>
        And now, we‚Äôre also just days away from our <strong>1-year anniversary on 7th March</strong>. One whole year of us. One year of memories, growth, and standing by each other. I‚Äôm so proud of what we‚Äôve built.<br><br>
        You are my comfort, my happiness, and my peace. Loving you feels right, and being with you feels like home.<br><br>
        <strong>Happy Valentine‚Äôs Day, my love. Here‚Äôs to forever.</strong>`;

        let typeStarted = false;
        function typeWriter(text, element, speed = 30) {
            let i = 0; element.innerHTML = "";
            function type() {
                if (i < text.length) {
                    if (text.charAt(i) === '<') {
                        let tag = ''; while (text.charAt(i) !== '>') { tag += text.charAt(i); i++; }
                        tag += '>'; i++; element.innerHTML += tag;
                    } else { element.innerHTML += text.charAt(i); i++; }
                    setTimeout(type, speed);
                } else { document.querySelector('.cursor-blink').style.display = 'none'; }
            }
            type();
        }

        const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting && !typeStarted) {
                typeStarted = true;
                typeWriter(noteText, document.getElementById('typewriterText'));
            }
        }, { threshold: 0.3 });
        observer.observe(document.getElementById('noteSection'));

        // FLOATING HEARTS
        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('floating-heart');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = Math.random() * 3 + 4 + 's'; 
            document.getElementById('heartsContainer').appendChild(heart);
            setTimeout(() => heart.remove(), 7000);
        }
        setInterval(createHeart, 500);

        // REASONS
        const reasons = ["Your smile lights up my day.", "You listen like no one else.", "The way you look at me.", "Your unconditional support.", "Your laugh is my favorite sound.", "You make boring moments fun.", "You are beautiful inside and out.", "You always know how to cheer me up."];
        function generateReason() {
            const text = document.getElementById('reasonText');
            text.style.opacity = 0;
            setTimeout(() => {
                text.innerText = reasons[Math.floor(Math.random() * reasons.length)];
                text.style.opacity = 1;
            }, 200);
        }

        // SURPRISE VIDEO LOGIC
        function revealVideo() {
            const btn = document.getElementById('surpriseBtn');
            const container = document.getElementById('videoContainer');
            const video = document.getElementById('surpriseVideo');
            const music = document.getElementById('bgMusic');
            const musicBtn = document.getElementById('musicBtn');
            
            // Hide button, show container
            btn.style.display = 'none';
            container.classList.remove('hidden');
            
            // Trigger reflow
            void container.offsetWidth;
            
            // Animate in
            container.classList.remove('opacity-0', 'scale-95');
            container.classList.add('opacity-100', 'scale-100');
            
            // Pause background music if playing
            if (!music.paused) {
                music.pause();
                musicBtn.innerText = "üîá";
            }

            // Play video
            setTimeout(() => {
                video.play().catch(e => console.log("Autoplay prevented:", e));
            }, 300);
        }

        function closeVideo() {
            const btn = document.getElementById('surpriseBtn');
            const container = document.getElementById('videoContainer');
            const video = document.getElementById('surpriseVideo');
            
            video.pause();
            
            // Animate out
            container.classList.remove('opacity-100', 'scale-100');
            container.classList.add('opacity-0', 'scale-95');
            
            setTimeout(() => {
                container.classList.add('hidden');
                btn.style.display = 'inline-flex';
            }, 700);
        }
    </script>
</body>
</html>